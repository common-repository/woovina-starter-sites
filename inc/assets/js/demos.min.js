!function(o){"use strict";o(document).ready(function(){a.init()});var a={importData:{},allowPopupClosing:!0,init:function(){var a=this;this.categoriesFilter(),o(".woovina-search-input").on("keyup",function(){0<o(this).val().length?(o(".woovina-demo-wrap .themes").find(".theme-wrap").hide(),o(".woovina-demo-wrap .themes").find('.theme-wrap[data-name*="'+o(this).val().toLowerCase()+'"]').show()):o(".woovina-demo-wrap .themes").find(".theme-wrap").show()}),o(".woovina-demo-wrap .theme-actions a.button").on("click",function(o){o.stopPropagation()}),o(".woovina-open-popup").click(function(t){t.preventDefault();var e=o(this).data("demo-id"),i=o(this).find("div.preview-icon"),n=o(this).find("div.preview-all");i.show(),n.show(),a.getDemoData(e)}),o(document).on("click",".install-now",this.installNow),o(document).on("click",".activate-now",this.activatePlugins),o(document).on("wp-plugin-install-success",this.installSuccess),o(document).on("wp-plugin-installing",this.pluginInstalling),o(document).on("wp-plugin-install-error",this.installError),o(document).on("click",".install-woovina-package",this.installWooVinaNow)},categoriesFilter:function(){var a=o(".woovina-demo-wrap .themes").find(".theme-wrap"),t=function(t){var e=o.Deferred();return function(){var t=o.Deferred();return a.addClass("woovina-is-fadeout"),setTimeout(function(){a.removeClass("woovina-is-fadeout").hide(),t.resolve()},200),t.promise()}().done(function(){!function(o,t){var e=o?'[data-categories*="'+o+'"]':"div";"all"===o&&(e="div"),a.filter(e).show().addClass("woovina-is-fadein"),setTimeout(function(){a.removeClass("woovina-is-fadein"),t.resolve()},200)}(t,e)}),e};o(".woovina-navigation-link").on("click",function(a){a.preventDefault(),o(this).parent().siblings().removeClass("active"),o(this).parent().addClass("active");var e=this.hash.slice(1),i=o(".woovina-demo-wrap .themes");i.css("min-width",i.outerHeight()),t(e).done(function(){i.removeAttr("style")})})},getDemoData:function(a){var t=this;o.ajax({url:woovinaDemos.ajaxurl,type:"get",data:{action:"woovina_ajax_get_import_data",demo_name:a,security:woovinaDemos.woovina_import_data_nonce},complete:function(a){t.importData=o.parseJSON(a.responseText)}}),o.ajax({url:woovinaDemos.ajaxurl,type:"get",data:{action:"woovina_ajax_get_demo_data",demo_name:a,demo_data_nonce:woovinaDemos.demo_data_nonce},complete:function(a){t.runPopup(a);var e=o("div.preview-icon"),i=o("div.preview-all");e.hide(),i.hide()}})},runPopup:function(a){var t=this,e=o("html").innerWidth();o("html").css("overflow","hidden");var i=o("html").innerWidth();o("html").css("margin-right",i-e),o("#woovina-demo-popup-wrap").fadeIn(),o(a.responseText).appendTo(o("#woovina-demo-popup-content")),o(".woovina-demo-popup-close, .woovina-demo-popup-overlay").on("click",function(o){o.preventDefault(),!0===t.allowPopupClosing&&t.closePopup()}),o(".woovina-plugins-next").on("click",function(a){a.preventDefault(),o("#woovina-demo-plugins").hide(),o("#woovina-demo-import-form").show()}),o("#woovina-demo-import-form").submit(function(a){a.preventDefault();var e=o(this).find('[name="woovina_import_demo"]').val(),i=o(this).find('[name="woovina_import_demo_data_nonce"]').val(),n=[];o(this).find('input[type="checkbox"]').each(function(){!0===o(this).is(":checked")&&n.push(o(this).attr("name"))}),o(this).hide(),o(".woovina-loader").show(),t.importContent({demo:e,nonce:i,contentToImport:n,isXML:o("#woovina_import_xml").is(":checked")})})},importContent:function(a){var t,e,i=this,n=(Date.now(),{woovina_import_demo:a.demo,woovina_import_demo_data_nonce:a.nonce});if(this.allowPopupClosing=!1,o(".woovina-demo-popup-close").fadeOut(),0===a.contentToImport.length)return setTimeout(function(){0==o(".woovina-loader").find(".woovina-importing-failed").length?(o(".woovina-loader").hide(),o(".woovina-last.woovina-success").show()):o(".woovina-last.woovina-error").show()},1e3),o.ajax({url:woovinaDemos.ajaxurl,type:"post",data:{action:"woovina_after_import",woovina_import_demo:a.demo,woovina_import_demo_data_nonce:a.nonce,woovina_import_is_xml:a.isXML},complete:function(o){}}),this.allowPopupClosing=!0,void o(".woovina-demo-popup-close").fadeIn();for(var s in this.importData){var l=o.inArray(this.importData[s].input_name,a.contentToImport);if(-1!==l){t=s,a.contentToImport.splice(l,1),n.action=this.importData[s].action;break}}o(".woovina-import-status").append('<p class="woovina-importing">'+this.importData[t].loader+"</p>");var r=o.ajax({url:woovinaDemos.ajaxurl,type:"post",data:n,complete:function(t){clearTimeout(e);var n=!0;if(500===t.status||502===t.status||503===t.status)o(".woovina-importing").addClass("woovina-importing-failed").removeClass("woovina-importing").text(woovinaDemos.content_importing_error+" "+t.status);else if(-1!==t.responseText.indexOf("successful import"))o(".woovina-importing").addClass("woovina-imported").removeClass("woovina-importing");else{var s=o.parseJSON(t.responseText),l="";for(var r in s)l+=s[r],"xml_import_error"===r&&(n=!1);o(".woovina-importing").addClass("woovina-importing-failed").removeClass("woovina-importing").text(l),i.allowPopupClosing=!0,o(".woovina-demo-popup-close").fadeIn()}!0===n&&i.importContent(a)}});e=setTimeout(function(){r.abort(),i.allowPopupClosing=!0,o(".woovina-demo-popup-close").fadeIn(),o(".woovina-importing").addClass("woovina-importing-failed").removeClass("woovina-importing").text(woovinaDemos.content_importing_error)},9e5)},closePopup:function(){o("html").css({overflow:"","margin-right":""}),o(".preview-icon").hide(),o(".preview-all").hide(),o("#woovina-demo-popup-wrap").fadeOut(),setTimeout(function(){o("#woovina-demo-popup-content").html("")},600)},installNow:function(a){a.preventDefault();var t=o(a.target),e=t.data("init"),i=t.data("slug"),n=t.data("type"),s=o(document);if(!t.hasClass("updating-message")&&!t.hasClass("button-disabled")){if(wp.updates.shouldRequestFilesystemCredentials&&!wp.updates.ajaxLocked&&(wp.updates.requestFilesystemCredentials(a),s.on("credential-modal-cancel",function(){o(".install-now.updating-message").removeClass("updating-message").text(wp.updates.l10n.installNow),wp.a11y.speak(wp.updates.l10n.updateCancel,"polite")})),"premium"==n)return t.addClass("updating-message"),void o.ajax({url:woovinaDemos.ajaxurl,type:"POST",data:{action:"woovina_ajax_install_plugin",slug:i,init:e}}).done(function(a){t.addClass("activate-now updating-message button-primary").removeClass("install-now").html(woovinaDemos.button_activating),setTimeout(function(){o.ajax({url:woovinaDemos.ajaxurl,type:"POST",data:{action:"woovina_ajax_required_plugins_activate",init:e}}).done(function(o){o.success?t.removeClass("button-primary install-now activate-now updating-message").attr("disabled","disabled").addClass("disabled").text(woovinaDemos.button_active):t.removeClass("updating-message")})},1200)});wp.updates.installPlugin({slug:t.data("slug")})}},installWooVinaNow:function(a){a.preventDefault();var t=o(a.target);o(document);t.hasClass("updating-message")||t.hasClass("button-disabled")||(t.addClass("updating-message"),o.ajax({url:woovinaDemos.ajaxurl,type:"POST",data:{action:"woovina_ajax_install_theme"}}).done(function(o){t.removeClass("button-primary install-now activate-now updating-message").attr("disabled","disabled").addClass("disabled").text(woovinaDemos.button_active)}))},activatePlugins:function(a){a.preventDefault();var t=o(a.target),e=t.data("init");t.data("slug");t.hasClass("updating-message")||t.hasClass("button-disabled")||(t.addClass("updating-message button-primary").html(woovinaDemos.button_activating),o.ajax({url:woovinaDemos.ajaxurl,type:"POST",data:{action:"woovina_ajax_required_plugins_activate",init:e}}).done(function(o){o.success&&t.removeClass("button-primary install-now activate-now updating-message").attr("disabled","disabled").addClass("disabled").text(woovinaDemos.button_active)}))},installSuccess:function(a,t){a.preventDefault();var e=o(".woovina-plugin-"+t.slug).find(".button"),i=e.data("init");e.removeClass("install-now installed button-disabled updated-message").addClass("updating-message").html(woovinaDemos.button_activating),setTimeout(function(){o.ajax({url:woovinaDemos.ajaxurl,type:"POST",data:{action:"woovina_ajax_required_plugins_activate",init:i}}).done(function(o){o.success?e.removeClass("button-primary install-now activate-now updating-message").attr("disabled","disabled").addClass("disabled").text(woovinaDemos.button_active):e.removeClass("updating-message")})},1200)},pluginInstalling:function(a,t){a.preventDefault(),o(".woovina-plugin-"+t.slug).find(".button").addClass("updating-message")},installError:function(a,t){a.preventDefault(),o(".woovina-plugin-"+t.slug).removeClass("button-primary").addClass("disabled").html(wp.updates.l10n.installFailedShort)}}}(jQuery);